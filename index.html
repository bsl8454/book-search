<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LH ë°¤ì†¡ì´ ì‘ì€ë„ì„œê´€ ë„ì„œê²€ìƒ‰</title>
    <style>
        /* ê¹”ë”í•œ ë””ìì¸ì„ ìœ„í•œ ìŠ¤íƒ€ì¼ */
        body { font-family: 'Malgun Gothic', sans-serif; line-height: 1.6; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f4f7f6; }
        .header { text-align: center; margin-bottom: 30px; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; font-size: 24px; margin-bottom: 10px; }
        .info-text { font-size: 0.9em; color: #666; margin-bottom: 15px; }
        
        .search-container { display: flex; gap: 5px; margin-bottom: 20px; }
        #search-input { flex-grow: 1; padding: 12px; border: 2px solid #3498db; border-radius: 5px; font-size: 16px; }
        button { padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { background: #2980b9; }

        #result-count { margin-bottom: 10px; font-weight: bold; color: #34495e; }
        .book-item { background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); border-left: 5px solid #3498db; }
        .book-title { font-size: 18px; color: #2c3e50; display: block; margin-bottom: 5px; }
        .book-details { font-size: 14px; color: #7f8c8d; }
        .highlight { color: #e74c3c; font-weight: bold; }
    </style>
</head>
<body>

    <div class="header">
        <h1>ğŸ“š LH ë°¤ì†¡ì´ ì‘ì€ë„ì„œê´€</h1>
        <p class="info-text">* í˜„ì¬ ì†Œì¥ ì¤‘ì¸ ë„ì„œ ëª©ë¡ë§Œ ê²€ìƒ‰ë©ë‹ˆë‹¤.<br>(ëŒ€ì¶œ ê°€ëŠ¥ ì—¬ë¶€ëŠ” ë°©ë¬¸ í™•ì¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤.)</p>
        
        <div class="search-container">
            <input type="text" id="search-input" placeholder="ë„ì„œëª… ë˜ëŠ” ì €ìë¥¼ ì…ë ¥í•˜ì„¸ìš”" onkeypress="if(event.keyCode==13) searchBooks()">
            <button onclick="searchBooks()">ê²€ìƒ‰</button>
        </div>
    </div>

    <div id="result-count"></div>
    <div id="results"></div>

    <script>
        let books = [];

        // 1. CSV íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
        fetch('books.csv')
            .then(response => response.text())
            .then(data => {
                // ì¤„ë°”ê¿ˆìœ¼ë¡œ ë‚˜ëˆ„ê³  ì²« ì¤„(ì œëª©)ì€ ì œì™¸
                const rows = data.split('\n').filter(row => row.trim() !== '');
                books = rows.slice(1).map(row => {
                    // ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ë˜, í°ë”°ì˜´í‘œ ì•ˆì˜ ì‰¼í‘œëŠ” ë¬´ì‹œí•˜ëŠ” ì •ê·œì‹
                    return row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                });
            })
            .catch(err => console.error("íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", err));

        // 2. ê²€ìƒ‰ í•¨ìˆ˜
        function searchBooks() {
            const query = document.getElementById('search-input').value.trim().toLowerCase();
            const resultsDiv = document.getElementById('results');
            const countDiv = document.getElementById('result-count');
            
            if (query === "") {
                alert("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            // ê²€ìƒ‰ í•„í„°ë§ (ì œëª© ë˜ëŠ” ì €ìì— í¬í•¨ëœ ê²½ìš°)
            const filtered = books.filter(book => {
                return book.some(field => field.toLowerCase().includes(query));
            });

            // ê²°ê³¼ í‘œì‹œ
            countDiv.innerHTML = `ì´ ${filtered.length}ê±´ì´ ê²€ìƒ‰ë˜ì—ˆìŠµë‹ˆë‹¤.`;
            resultsDiv.innerHTML = "";

            if (filtered.length === 0) {
                resultsDiv.innerHTML = "<p style='text-align:center; padding:20px;'>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
                return;
            }

            filtered.forEach(book => {
                const div = document.createElement('div');
                div.className = 'book-item';
                // ì—‘ì…€ ì—´ ìˆœì„œì— ë”°ë¼ ìˆ˜ì •ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ì˜ˆ: 1ë²ˆ ì œëª©, 2ë²ˆ ì €ì, 3ë²ˆ ì¶œíŒì‚¬)
                div.innerHTML = `
                    <span class="book-title">${book[1] || 'ì œëª© ì—†ìŒ'}</span>
                    <div class="book-details">
                        ì €ì: ${book[2] || '-'} | ì¶œíŒì‚¬: ${book[3] || '-'} <br>
                        ë“±ë¡ë²ˆí˜¸: ${book[0] || '-'}
                    </div>
                `;
                resultsDiv.appendChild(div);
            });
        }
    </script>
</body>
</html>
