async function searchBooks() {
    const query = document.getElementById('searchQuery').value.trim();
    const resultsContainer = document.getElementById('results');
    
    if (!query) {
        alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
        return;
    }

    resultsContainer.innerHTML = '<p>ğŸ” ê²€ìƒ‰ ì¤‘ì…ë‹ˆë‹¤...</p>';

    // ê´€ì¥ë‹˜ ì‹œíŠ¸ ì§í†µ ì£¼ì†Œ
    const url = 'https://docs.google.com/spreadsheets/d/1V9GGjLnsHGWjJu-GT__MlgX3ZXSeHvwIsEYDIbEjpxw/gviz/tq?tqx=out:json&gid=2045470469';

    try {
        const response = await fetch(url);
        const text = await response.text();
        const json = JSON.parse(text.substring(47).slice(0, -2));
        const rows = json.table.rows;

        // ì‹œíŠ¸ ì—´ ìˆœì„œì— ë§ì¶° ë°ì´í„° ì¶”ì¶œ (Cì—´: ì œëª©, Dì—´: ì €ì...)
        const results = rows
            .map(row => ({
                title: row.c[2] ? String(row.c[2].v) : '',     
                author: row.c[3] ? String(row.c[3].v) : '',    
                publisher: row.c[4] ? String(row.c[4].v) : '', 
                image: row.c[7] ? String(row.c[7].v) : ''      
            }))
            .filter(book => book.title.includes(query) || book.author.includes(query));

        displayResults(results);
    } catch (error) {
        console.error('Error:', error);
        resultsContainer.innerHTML = '<p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>';
    }
}

function displayResults(results) {
    const resultsContainer = document.getElementById('results');
    resultsContainer.innerHTML = '';

    if (results.length === 0) {
        resultsContainer.innerHTML = '<p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
    }

    results.forEach(book => {
        const div = document.createElement('div');
        div.className = 'book-item';
        div.innerHTML = `
            <div class="book-info">
                <div class="book-title" style="font-weight:bold; color:#2c3e50;">${book.title}</div>
                <div class="book-author" style="color:#7f8c8d; font-size:0.9em;">${book.author} | ${book.publisher}</div>
            </div>
            <hr style="border:0; border-top:1px solid #eee; margin:10px 0;">
        `;
        resultsContainer.appendChild(div);
    });
}
